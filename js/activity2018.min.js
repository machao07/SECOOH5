var app = function(e, t) {
    var a = e.location.href,
        i = e.location.search,
        o = "iphone.secoo.com",
        n = "android.secoo.com",
        r = e.location.host,
        s = e.navigator.userAgent,
        c = location.protocol,
        d = e.pageConfig,
        p = d.openDebug,
        l = d.initLoad,
        u = (d.initHead, e.screen.width),
        g = e.screen.height,
        m = 0 == t.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp"),
        h = {
            isInit: !1,
            canGoPage: !0,
            androidVersion: "6.0.12",
            iosVersion: "6.0.14",
            systemMsg: {
                fnUndefined: "该方法未注册",
                noUseNativeFn: "请在寺库app内体验该功能",
                appVersionIsLow: "您的app版本过低，请升级至最新版本"
            },
            template: {
                toastTpl: '<div class="toast"><span></span></div>',
                headBarTpl: '<header id="header">							<div class="leftBtn header_icon_back header_iconfont"></div>							<h1 class="title"></h1>							<div class="rightBtn por">								<span class="icon header_iconfont header_icon_menu"></span>								<ul class="bindEventList"></ul>							</div>						</header>'
            },
            templateData: {
                headBarData: [{
                    className: "header_iconfont header_icon_index",
                    urlType: "url",
                    url: "//m.secoo.com",
                    innerHtml: "首页"
                }, {
                    className: "header_iconfont header_icon_bag",
                    urlType: "url",
                    url: "//m.secoo.com/v1/shoppingCart/",
                    innerHtml: "购物袋"
                }, {
                    className: "header_iconfont header_icon_my",
                    urlType: "url",
                    url: "//m.secoo.com/user.html",
                    innerHtml: "我的寺库"
                }]
            },
            jsArr: {
                defaultJs: ["js/zepto.min.js"],
                ios: ["//mstatic.secooimg.com/activity2018/all_min/js/WebViewJavascriptBridge_ios.min.js", "//mstatic.secooimg.com/activity2018/js/comm/md5.js"],
                android: [],
                wap: ["js/weixin.sdk1.3.2.js"],
                miniProgram: ["js/weixin.sdk1.3.2.js"],
                baiduProgram: ["//b.bdstatic.com/searchbox/icms/searchbox/js/swan.js"]
            },
            statistic: {
                google: function() {
                    return e.ga && "function" == typeof e.ga || (! function(e, t, a, i, o, n, r) {
                        e.GoogleAnalyticsObject = o, e[o] = e[o] || function() {
                            (e[o].q = e[o].q || []).push(arguments)
                        }, e[o].l = 1 * new Date, n = t.createElement(a), r = t.getElementsByTagName("head")[0], n.async = 1, n.src = i, r.appendChild(n, r)
                    }(e, t, "script", "//www.google-analytics.com/analytics.js", "ga"), ga("create", "UA-67552012-1", "auto"), ga("require", "displayfeatures"), ga("require", "linkid", "linkid.js"), ga("send", "pageview")), this
                },
                baidu: function() {
                    e._hmt = e._hmt || [];
                    var t = document.createElement("script");
                    t.src = "//hm.baidu.com/hm.js?1a9931d6b2f70b8919e322ffa17dbfe5";
                    var a = document.getElementsByTagName("script")[0];
                    return a.parentNode.insertBefore(t, a), this
                },
                sensors: function(e) {
                    var t = e.sdk_url,
                        a = e.name,
                        i = window,
                        o = document,
                        n = "script",
                        r = null,
                        s = null;
                    i.sensorsDataAnalytic201505 = a, i[a] = i[a] || function(e) {
                        return function() {
                            (i[a]._q = i[a]._q || []).push([e, arguments])
                        }
                    };
                    for (var c = ["track", "quick", "register", "registerPage", "registerOnce", "trackSignup", "trackAbtest", "setProfile", "setOnceProfile", "appendProfile", "incrementProfile", "deleteProfile", "unsetProfile", "identify", "login", "logout", "trackLink", "clearAllRegister", "getAppStatus"], d = 0; d < c.length; d++) i[a][c[d]] = i[a].call(null, c[d]);
                    i[a]._t || (r = o.createElement(n), s = o.getElementsByTagName(n)[0], r.async = 1, r.src = t, r.setAttribute("charset", "UTF-8"), s.parentNode.insertBefore(r, s), i[a].para = e), sensors.quick("autoTrack")
                }
            },
            tools: {
                "typeof": function(e, t) {
                    var a = Object.prototype.toString.call(e).slice(8, -1).toLowerCase();
                    return t ? a === t : a
                },
                deepMerge: function(e, t, a) {
                    var i = this,
                        a = "notDeep" === a ? !1 : !0;
                    for (var o in t) {
                        var n = e[o];
                        (a || t[o]) && (e[o] = n && i.typeof(n, "object") ? h.tools.deepMerge(n, t[o]) : t[o])
                    }
                    return e
                },
                concatJs: function(e) {
                    var t = h.exports,
                        a = t.getDeviceType(),
                        i = h.jsArr[a],
                        o = h.jsArr.defaultJs,
                        n = [];
                    if ((p || 1 == t.getQueryString("openDebug")) && o.unshift("//mstatic.secooimg.com/activity2018/js/comm/eruda.min.js"), "wap" != a || !l && 1 != t.getQueryString("fromShare") || l + "" == "false" || o.push("//mstatic.secooimg.com/m_secoo/v1/common/js/utils/dlApp.min.js"), h.exports.matchVersion({
                            android: h.androidVersion
                        }, function() {
                            o.push("//mstatic.secooimg.com/activity2018/all_min/js/WebViewJavascriptBridge_android.min.js")
                        }, function() {
                            window.Jsbridge || o.push("//mstatic.secooimg.com/activity2018/all_min/js/jsBridge_android_old.min.js"), o.push("//mstatic.secooimg.com/activity2018/all_min/js/compatible.min.js")
                        }), h.exports.matchVersion({
                            ios: h.iosVersion
                        }, function() {}, function() {
                            o.push("//mstatic.secooimg.com/activity2018/all_min/js/compatible.min.js")
                        }), e) switch (this.typeof(e)) {
                        case "object":
                            e[a] && (n = n.concat(e[a]));
                            break;
                        case "array":
                            n = n.concat(e);
                            break;
                        case "string":
                            n.push(e)
                    }
                    return o.concat(i, n)
                }
            },
            setRem: function(a) {
                var i = t.documentElement,
                    o = "orientationchange" in window ? "orientationchange" : "resize",
                    n = function() {
                        var e = i.clientWidth;
                        e && (i.style.fontSize = e / a + "px")
                    };
                n(), t.addEventListener && (e.addEventListener(o, n, !1), t.addEventListener("DOMContentLoaded", n, !1))
            },
            extendOriginObj: function() {
                String.prototype.replaceAll = function(e, t, a) {
                    return RegExp.prototype.isPrototypeOf(e) ? this.replace(e, t) : this.replace(new RegExp(e, a ? "gi" : "g"), t)
                }, String.prototype.trim = function() {
                    return this.replace(/^\s+|\s+$/g, "")
                }, Date.prototype.format = function(e) {
                    var t = {
                        "M+": this.getMonth() + 1,
                        "d+": this.getDate(),
                        "h+": this.getHours(),
                        "m+": this.getMinutes(),
                        "s+": this.getSeconds(),
                        "q+": Math.floor((this.getMonth() + 3) / 3),
                        "S+": this.getMilliseconds()
                    };
                    /(y+)/i.test(e) && (e = e.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length)));
                    for (var a in t) new RegExp("(" + a + ")").test(e) && (e = e.replace(RegExp.$1, 1 == RegExp.$1.length ? t[a] : ("00" + t[a]).substr(("" + t[a]).length)));
                    return e
                }
            },
            exports: {
                newVersion: !1,
                href: a,
                search: i,
                deviceType: {
                    baiduProgram: s.indexOf("baiduboxapp") > -1,
                    miniProgram: a.indexOf("deviceType=miniProgram") > -1,
                    weixin: !!s.match(/MicroMessenger/i),
                    android: s.indexOf("Android") > -1 || s.indexOf("Adr") > -1,
                    ios: s.indexOf("iPhone") > -1,
                    androidApp: s.indexOf("AndroidApp") > -1 || n == r,
                    iosApp: s.indexOf("Secoo-iPhone") > -1 || o == r,
                    inApp: ""
                },
                supportWebp: m,
                uuid: t.querySelector("body").getAttribute("uuid"),
                pageid: "",
                shareParams: {
                    title: t.querySelector("title").innerHTML,
                    des: "刚刚在寺库看到一个活动，太赞了！小伙伴们快来围观！全球直采，又快又省！",
                    imgUrl: "https://mstatic.secooimg.com/activity2018/all_min/img/secoo_logo.jpg",
                    url: a.replace(/(\/\/android\.|\/\/iphone\.)/gi, "//m."),
                    noToast: !1
                },
                regHandle: function(e, t) {
                    var a = this,
                        i = h.tools;
                    switch (i.typeof(e)) {
                        case "object":
                            i.deepMerge(a, e);
                            break;
                        case "string":
                            var o = a[e];
                            a[e] = o ? o : t
                    }
                },
                callHandle: function(e, t) {
                    var a = this[e];
                    return a ? a(t) : console.error(e + ":" + h.systemMsg.fnUndefined)
                },
                getDom: function(e, a) {
                    return a ? t.querySelectorAll(e) : t.querySelector(e)
                },
                creatDom: function(e) {
                    var a = this,
                        i = e.dom,
                        o = e.callback,
                        n = e.attrs,
                        r = n ? n.url : e.url,
                        s = t.createElement(i),
                        c = {
                            script: {
                                src: r,
                                type: "text/javascript"
                            },
                            link: {
                                href: r,
                                rel: "stylesheet"
                            }
                        };
                    e.async && (c.script.async = e.async), a.getDom(e.fatherDom || "head").appendChild(a.setDomAttr(s, c[i] || e.attrs)), c[i] ? s.onload = function() {
                        o && o(s)
                    } : o && o(s)
                },
                setDomAttr: function(e, t) {
                    for (var a in t) e.setAttribute(a, t[a]);
                    return e
                },
                matchVersion: function(e, t, a) {
                    function i(e, t) {
                        if (!e || !t) return -1;
                        var a = 0;
                        return t = t.split("."), e.split(".").some(function(e, i) {
                            return a = e - t[i]
                        }), a
                    }
                    var o = (h.exports, this),
                        n = o.getDeviceType();
                    e[n] && o.getVersion(function(r) {
                        i(r, e[n]) >= 0 ? (h.isInit || (o.newVersion = !0), t && t()) : a && a()
                    })
                },
                getVersion: function(e) {
                    function t(e) {
                        var t, a = new RegExp("(^| )" + e + "=([^;]*)(;|$)");
                        return (t = document.cookie.match(a)) ? decodeURIComponent(t[2]) : null
                    }
                    var a = this,
                        i = a.getDeviceType(),
                        o = /AppInfo-\((.+)\)\s?/,
                        n = /com.secoo\/(.+)\s?/;
                    if ("ios" == i) {
                        var r = s && o.exec(s);
                        if (r) e && e(r[1].split("/")[2]);
                        else try {
                            jsBridge.callHandler("WVJS_acqureDeviceInfomation", {}, function(t) {
                                e && e(t.appVersion)
                            })
                        } catch (c) {
                            console.log(c), e && e("0.0.0")
                        }
                    } else if ("android" == i) {
                        var d = s && n.exec(s) && n.exec(s)[1],
                            p = d || t("androidAppVersion") || t("appVersion");
                        if (d || p) e && e(p);
                        else try {
                            jsBridge.callHandler("JsCallNativeMethod", {
                                action: "getAppInfo",
                                needResult: !0
                            }, function(t) {
                                e && e(t.data.appVersion)
                            })
                        } catch (c) {
                            console.log(c, "获取版本号失败，开始启用新版本"), e && e("999.999.999")
                        }
                    }
                },
                statistics: function(e) {
                    var t = this,
                        a = t.getDeviceType();
                    $.extend(e, d.statisticsData || {}), e["s.ot"] = e["s.ot"] || "2";
                    try {
                        if ("ios" == a) jsBridge.callHandler("statsJSEventInfo", e, function() {});
                        else if (t.newVersion && "android" == a) {
                            var i = {};
                            $.each(e, function(e, t) {
                                i[e + ""] = t + ""
                            }), jsBridge.callHandler("JsCallNativeMethod", {
                                action: "log",
                                data: i
                            })
                        }
                        var o = {};
                        $.each(e, function(e, t) {
                            var e = e.replace(".", "_");
                            o[e] = t
                        }), o.s_title = t.getDom("title").innerHTML, e = o, sensors.track("h5_click", e), (d.showStatisticsData || 1 == t.getQueryString("showStatisticsData")) && console.log("埋点数据：", e)
                    } catch (n) {
                        console.log(n, "埋点失败")
                    }
                },
                getUpk: function(e) {
                    var t = this,
                        a = t.getDeviceType();
                    switch (a) {
                        case "wap":
                            e && e(t.cookie("Sid"));
                            break;
                        case "ios":
                        case "android":
                            jsBridge.callHandler("JsCallNativeMethod", {
                                action: "getUserInfo",
                                needResult: !0
                            }, function(t) {
                                e && e(t.data.sid)
                            });
                            break;
                        case "miniProgram":
                            e && e(app.getQueryString("_wxupk") || "")
                    }
                },
                login: function(e, t) {
                    var i = this.getDeviceType();
                    switch (i) {
                        case "wap":
                            top.location.href = "https://m.secoo.com/v1/login/?redirect_uri=" + encodeURIComponent(t || a);
                            break;
                        case "ios":
                        case "android":
                            jsBridge.registerHandler("onLoginedIn", function(t) {
                                e && e(t)
                            }), jsBridge.callHandler("JsCallNativeMethod", {
                                action: "navigate",
                                data: {
                                    path: "app/login_page",
                                    jsHandle: "onLoginedIn"
                                }
                            });
                            break;
                        case "miniProgram":
                            wx.miniProgram.navigateTo({
                                url: "/pages/account/loginAccount/loginAccount?_wxurl=" + encodeURIComponent(t || a.replace(/\&_wxupk[\s\S]*/, ""))
                            });
                            break;
                        case "baiduProgram":
                    }
                },
                launchWXMiniProgram: function(e, t, a) {
                    jsBridge.callHandler("JsCallNativeMethod", {
                        action: "launchWXMiniProgram",
                        needResult: !0,
                        data: {
                            miniProgramId: e,
                            path: t
                        }
                    }, function(e) {
                        a && a(e.data.errorCode)
                    })
                },
                wapGoPage: function(e) {
                    var t = this,
                        a = e.type,
                        i = e.url || "",
                        o = e.params,
                        n = e.addFromId,
                        r = e.pageid ? e.pageid : i,
                        s = "";
                    switch (a) {
                        case "page":
                            s = "//m.secoo.com/appActivity/" + i + ".shtml?pageid=" + r + (o ? "&" + o : "");
                            break;
                        case "product":
                            s = "//m.secoo.com/proDetail_1217.html?prodId=" + i + (n ? "&addFrom=" + n : "");
                            break;
                        case "keyword":
                            s = "//m.secoo.com/v1/list?keyword=" + encodeURIComponent(i) + (o && "&opt_params=" + t.urlParamsToJson(o, !0) || "");
                            break;
                        case "brand":
                            s = "//m.secoo.com/v1/list?type=brand&keyword=" + encodeURIComponent(i) + "&" + o;
                            break;
                        case "category":
                            s = "//m.secoo.com/v1/list?type=category&keyword=" + encodeURIComponent(i) + "&" + o;
                            break;
                        case "ticket":
                            s = "//m.secoo.com/v1/list?type=ticket&ticketId=" + encodeURIComponent(i);
                            break;
                        case "url":
                            s = i + (n ? (i.indexOf("?") > -1 ? "&addFrom=" : "?addFrom=") + n : "")
                    }
                    top.location.href = s
                },
                androidGoPage: function(e) {
                    {
                        var t = this,
                            a = e.type;
                        e.url, e.title, e.params, e.addFromId
                    }
                    switch (a) {
                        case "page":
                        case "product":
                        case "keyword":
                        case "brand":
                        case "ticket":
                        case "url":
                            t.nativeGoPage(e);
                            break;
                        case "auction":
                    }
                },
                iosGoPage: function(e) {
                    {
                        var t = this,
                            a = e.type;
                        e.url, e.title, e.params, e.addFromId, e.activityId
                    }
                    switch (a) {
                        case "page":
                        case "product":
                        case "keyword":
                        case "brand":
                        case "ticket":
                        case "url":
                            t.nativeGoPage(e);
                            break;
                        case "auction":
                    }
                },
                nativeGoPage: function(e) {
                    function t(e) {
                        for (var e = e ? e.split("&") : [], t = [], a = 0; a < e.length; a++) {
                            var i = e[a].split("="),
                                o = {};
                            o.key = i[0], o.value = "price" == i[0] ? [i[1]] : i[1].split("_"), t.push(o)
                        }
                        return t
                    }
                    var a = this,
                        i = e.type,
                        o = e.url,
                        n = e.title,
                        r = e.params,
                        s = e.addFromId,
                        d = !!e.showShareButton,
                        p = "ios" == a.getDeviceType() ? "iphone" : "android",
                        l = e.pageid ? e.pageid : o,
                        u = {};
                    switch (i) {
                        case "page":
                            u = {
                                path: "app/webpage",
                                url: c + "//" + p + ".secoo.com/appActivity/" + o + ".shtml?pageid=" + l + (r ? "&" + r : ""),
                                navFrom: s,
                                showShareButton: d
                            };
                            break;
                        case "product":
                            u = {
                                path: "goods/detail_item",
                                id: o + "",
                                addFrom: s,
                                navFrom: s
                            };
                            break;
                        case "keyword":
                        case "brand":
                        case "ticket":
                        case "category":
                            u = {
                                path: "app/search",
                                text: o,
                                type: i,
                                title: n,
                                filters: t(r),
                                trackLabelId: e.trackLabelId
                            };
                            break;
                        case "auction":
                            break;
                        case "url":
                            u = {
                                path: "app/webpage",
                                url: o + (s ? (o.indexOf("?") > -1 ? "&addFrom=" : "?addFrom=") + s : ""),
                                navFrom: s,
                                showShareButton: d
                            }
                    }
                    jsBridge.callHandler("JsCallNativeMethod", {
                        action: "navigate",
                        data: u
                    })
                },
                weixinGoPage: function(e) {
                    var t = this,
                        a = e.type,
                        i = e.url,
                        o = e.params,
                        n = e.addFromId,
                        r = "&pageid=" + (e.pageid ? e.pageid : i),
                        s = "",
                        c = app.getQueryString("_wxupk"),
                        d = "&deviceType=miniProgram";
                    switch (e.params = e.params ? e.params + "&" : "", e.params += "_wxupk=" + c + d, a) {
                        case "page":
                        case "url":
                            return t.wapGoPage(e), void 0;
                        case "miniPage":
                            s = i + (i.indexOf("?") > -1 ? "&" : "?") + o;
                            break;
                        case "product":
                            s = "/pages/product/detail/productDetail?productId=" + i + (n ? "&addFrom=" + n : "") + r;
                            break;
                        case "keyword":
                            s = "/pages/product/list/productList?searchType=0&keyword=" + i + r;
                            break;
                        case "brand":
                            s = "/pages/product/list/productList?searchType=1&brandId=" + i + r
                    }
                    wx.miniProgram.navigateTo({
                        url: s
                    })
                },
                baiduGoPage: function(e) {
                    var t = this,
                        a = e.type,
                        i = e.url,
                        o = e.params,
                        n = e.addFromId,
                        r = "&pageid=" + (e.pageid ? e.pageid : i),
                        s = "";
                    switch (a) {
                        case "page":
                        case "url":
                            return t.wapGoPage(e), void 0;
                        case "miniPage":
                            s = i + (i.indexOf("?") > -1 ? "&" : "?") + o;
                            break;
                        case "product":
                            s = "/pages/product/detail/productDetail?productId=" + i + (n ? "&addFrom=" + n : "") + r;
                            break;
                        case "keyword":
                            s = "/pages/product/list/productList?searchType=0&keyword=" + i + r;
                            break;
                        case "brand":
                            s = "/pages/product/list/productList?searchType=1&brandId=" + i + r
                    }
                    swan.webView.navigateTo({
                        url: s
                    })
                },
                goPage: function(e) {
                    var t = this,
                        a = t.getDeviceType();
                    switch (a) {
                        case "wap":
                            t.wapGoPage(e);
                            break;
                        case "ios":
                            t.iosGoPage(e);
                            break;
                        case "android":
                            t.androidGoPage(e);
                            break;
                        case "miniProgram":
                            t.weixinGoPage(e);
                            break;
                        case "baiduProgram":
                            t.baiduGoPage(e)
                    }
                },
                handleEventData: function(t, a, i) {
                    var o = t.attr("eventdata");
                    if (o) {
                        var n = $("#dataCollection"),
                            r = 1 == n.length && JSON.parse(n.attr("data-statistics")),
                            s = t.attr("data-statistics") && JSON.parse(t.attr("data-statistics")),
                            c = t.attr("addFrom"),
                            p = this,
                            l = JSON.parse(o),
                            m = l.type,
                            h = l.pcDate || l.productCode || l.url,
                            f = l.uuid || (p.uuid.indexOf("${sectionid?c}") > -1 ? "" : p.uuid),
                            v = e.location.hash,
                            y = f && v ? v.split("#")[1] + "_" + f : f,
                            w = {
                                0: "page",
                                3: "product",
                                4: "auction",
                                6: "keyword",
                                7: "brand",
                                100: "url"
                            },
                            b = w[m],
                            m = b || m,
                            k = h ? (h + "").indexOf("noShareBtn") > 0 : !1,
                            T = /activitylabel\d+\=(\d+)/i,
                            P = T.exec(l.query || l.params),
                            x = P && P[1] ? "label_" + P[1] : "",
                            S = {
                                statisticsData: {
                                    "s.x": parseInt(t.offset().left) + "",
                                    "s.y": parseInt(t.offset().top) + "",
                                    "s.paid": l.paid || p.getQueryString("pageid") || app.pageid,
                                    "s.opid": l.opid || encodeURIComponent(h) || x,
                                    "s.od": l.od || m,
                                    "s.os": l.os,
                                    "s.id": l.id,
                                    "s.sid": l.sid,
                                    "s.row": l.floorname || l.floor,
                                    "s.co": l.index,
                                    "s.ot": i ? "4" : l.ot || "2",
                                    "s.kwd": x,
                                    "s.sr": u + "x" + g
                                },
                                goPageData: {
                                    type: b || m,
                                    url: h || "",
                                    addFromId: c || y,
                                    params: l.query || l.params,
                                    title: l.title || "",
                                    showShareButton: k ? !1 : 0 != l.share,
                                    pageid: l.pageid,
                                    activityId: l.activityId || "",
                                    trackLabelId: x
                                }
                            };
                        return $.extend(S.statisticsData, d.statisticsData || r || {}, s || {}), $.each(S, function(e, t) {
                            $.each(t, function(t, a) {
                                S[e][t] = (S[e][t] + "").trim(), a || delete S[e][t]
                            })
                        }), !!d.showGoPageLog && console.log("页面跳转数据：", S), S
                    }
                },
                goPageAction: function(e, t) {
                    e.attr("stopPropagation") && t.stopPropagation();
                    var a = this,
                        i = a.handleEventData(e, t);
                    if (i) {
                        var o = i.goPageData;
                        a.statistics(i.statisticsData);
                        try {
                            window.sensors && sensors.quick("trackHeatMap", e.get(0))
                        } catch (n) {
                            console.log(n)
                        }
                        var r = null;
                        clearTimeout(r), (!d.showGoPageLog && h.canGoPage && !e.hasClass("noEvent") && !e.hasClass("noActivityLink") && o.type && o.url || "keyword" == o.type) && (h.canGoPage = !1, r = setTimeout(function() {
                            h.canGoPage = !0
                        }, 1e3), a.goPage(i.goPageData))
                    }
                },
                bindEvent: function() {
                    var t = this;
                    $(".bindEvent, .activityHandle").on("tap", function(e) {
                        t.goPageAction($(this), e)
                    }), $(".bindEventList, .activityHandles, .producodeUlList").on("tap", "li", function(e) {
                        t.goPageAction($(this), e)
                    }), $(".eventParent").on("tap", ".eventChild", function(e) {
                        t.goPageAction($(this), e)
                    }), $("._eventBind").on("tap", ".activityBind", function(e) {
                        t.goPageAction($(this), e)
                    }), $(".eventParent").on("tap", ".nativeShareBtn", function() {
                        e.nativeShare && e.nativeShare()
                    })
                },
                toast: function(e) {
                    var t = this;
                    if (t.deviceType.inApp && e) jsBridge.callHandler("JsCallNativeMethod", {
                        action: "updateUI",
                        data: {
                            viewId: "toast",
                            text: e,
                            duration: 0
                        }
                    });
                    else {
                        var a = $(".toast span");
                        0 == a.length ? ($("body").append(h.template.toastTpl), $(".toast span").on("webkitAnimationEnd", function() {
                            $(this).removeClass("toast-enter-active")
                        })) : e && a.text(e).addClass("toast-enter-active")
                    }
                },
                headBarInit: function(t) {
                    if (t.initHead !== !1 && "wap" === this.getDeviceType() && window === top && "1" != this.getQueryString("noWapHeader")) {
                        var a = $("html"),
                            i = $("body"),
                            o = h.templateData.headBarData,
                            n = h.template.headBarTpl,
                            t = o.concat(t.headerConfig || []),
                            r = "";
                        i.prepend(n);
                        for (var s = 0; s <= t.length - 1; s++) {
                            var c = t[s];
                            r += '<li eventdata=\'{"type":"' + c.urlType + '","url":"' + c.url + "\"}'><span class='" + c.className + "'></span><span>" + c.innerHtml + "</span></li>"
                        }
                        var d = i.find("#header"),
                            p = a.find("title").html() || "SECOO";
                        d.find(".title").html(p);
                        var l = d.find("ul");
                        l.html(r);
                        var u = d.find(".header_icon_back"),
                            g = d.find(".header_icon_menu");
                        u.on("tap", function() {
                            e.history.go(-1)
                        }), g.on("tap", function() {
                            l.toggleClass("show")
                        })
                    }
                },
                getDeviceType: function() {
                    var e = this.deviceType,
                        t = e.androidApp,
                        a = e.iosApp,
                        i = e.miniProgram,
                        o = e.baiduProgram;
                    return h.isInit || (e.inApp = t || a, e.wap = !(t || a || i || o)), t ? "android" : a ? "ios" : i ? "miniProgram" : o ? "baiduProgram" : "wap"
                },
                jsonToUrlParams: function(e, t) {
                    var a = "";
                    for (var i in e) {
                        var o = 0 == e[i] ? e[i] : e[i] || "";
                        o && (o = t ? encodeURIComponent(o) : o), a += i + "=" + o + "&"
                    }
                    return a.replace(/&$/, "")
                },
                urlParamsToJson: function(e, t) {
                    for (var a = {}, i = e.split("&"), o = 0; o < i.length; o++) {
                        var n = i[o].split("=");
                        n[1] && (a[n[0]] = n[1])
                    }
                    return a = JSON.stringify(a), t ? encodeURIComponent(a) : a
                },
                loadJs: function(t, a, i, o) {
                    function n(i) {
                        p !== i && s.creatDom({
                            dom: "script",
                            url: t[i],
                            callback: function() {
                                return n(++i), !r && e.$ && (r = !0, o && o()), p === i ? (a && a(), void 0) : void 0
                            }
                        })
                    }
                    var r = !1,
                        s = this;
                    if (i = i || !1, "string" == h.tools.typeof(t)) {
                        var c = t;
                        t = [], t.push(c)
                    }
                    var d = 0,
                        p = t.length;
                    if ("async" == i)
                        for (var l = 0; l <= t.length - 1; l++) s.creatDom({
                            dom: "script",
                            url: t[l],
                            async: "async",
                            callback: a
                        });
                    else n(d)
                },
                getPageId: function(e) {
                    var e = e || a,
                        t = e.match(/[^\/\.\?\#]+(?=\.(html|shtml))/),
                        i = this.getQueryString("pageid", e) || t && t[0];
                    return h.isInit || (app.pageid = i), i
                },
                tpl: function(e, t, a) {
                    var i = e.innerHTML || document.getElementById(e).innerHTML,
                        o = "var p = ''; p += '" + i.replace(/[\r\n\t]/g, " ").replace(/<%=(.*?)%>/g, "'; p += $1; p += '").replace(/<%/g, "';").replace(/%>/g, "p += '") + "'; return p;";
                    return t ? Function("data", "arg", o)(t, a) : Function("data", "arg", o)
                },
                cookie: function(e, t, a, i, o, n, r) {
                    var s = this,
                        c = arguments.length;
                    if (1 == c) {
                        var d = document.cookie.match(new RegExp("(^| )" + e + "=([^;]*)(;|$)"));
                        return d ? decodeURIComponent(d[2]) : null
                    }
                    var p = [];
                    if (p.push(e + "="), t && p.push(n ? t : encodeURIComponent(t)), null === t && s.cookie(e, "", -1), a) {
                        var l = new Date;
                        l.setHours(0), l.setMinutes(0), l.setSeconds(0), l.setTime(l.getTime() + 864e5 * a), p.push(";expires=" + l.toGMTString())
                    }
                    i && p.push(";domain=" + i), p.push(";path=" + (o || "/")), r && p.push(";secure"), document.cookie = p.join("")
                },
                getQueryString: function(e, t) {
                    t = t || a;
                    var i = t.match(new RegExp("([?&#])" + e.replace("#", "") + "=([^#&?]*)(\\s||$)", "gi"));
                    return i ? decodeURIComponent(i[0].split("=")[1]) : ""
                },
                priceFormat: function(e, t, a) {
                    var i;
                    return h.tools.typeof(t, "undefined") || (e = this.numberFormat(e, t, a)), i = (e + "").split("."), i[0] = i[0].replace(/(\d)(?=(\d{3})+$)/g, "$1,"), (i[0] + (2 == i.length ? "." + i[1] : "")).replace(/^\./g, "0.")
                },
                numberFormat: function(e, t, a) {
                    var i;
                    t = !h.tools.typeof(t, "number") || isNaN(1 * t) ? 2 : Math.abs(t), i = Math.pow(10, t), e *= 1;
                    var o = 9.9999e-11;
                    switch (a) {
                        case 1:
                            e = Math.ceil(e * i) / i;
                            break;
                        case -1:
                            e = Math.floor(e * i + o) / i;
                            break;
                        case 465:
                            var n = Math.floor(e * i + o) % 10 % 2,
                                r = Math.floor(e * i * 10 + o) % 10 == 5,
                                s = r && !n ? 1 / i : 0;
                            e = SEC.number.format(e, t) - s;
                            break;
                        default:
                            e = (e * i + o) / i
                    }
                    return (e.toFixed(t) + "").replace(/^\./g, "0.").replace(/\.$/, "")
                },
                getSeverTime: function(e) {
                    $.ajax({
                        type: "GET",
                        dataType: "jsonp",
                        url: "//las.secoo.com/api/rush_rob/current_time",
                        success: function(t) {
                            e && e(t.currentTime)
                        }
                    })
                },
                setProductPrice: function() {
                    function e(t) {
                        $.ajax({
                            type: "get",
                            dataType: "jsonp",
                            url: "//lr.secooimg.com/products?is_multi_spec=1",
                            data: "productIds=" + t.join(","),
                            success: function(e) {
                                for (var t = !1, a = 0, i = e.length; i > a; a++) {
                                    var o = $(".producodeUlList li[productcode='" + e[a].pidStr + "']"),
                                        n = e[a].secooPrice,
                                        r = e[a].phActName,
                                        s = e[a].phActPrice,
                                        c = e[a].originalSecooPrice;
                                    t || r && (t = !0), "activityExclusivePrice" in e[a] && Boolean(e[a].activityExclusivePrice) && (n = e[a].activityExclusivePrice), r ? c ? (o.find(".cp_siku").addClass("line").html("&yen;" + c), o.find(".activityPrice").html(r + ": &yen;" + s)) : (o.find(".cp_siku").html("&yen;" + n), o.find(".activityPrice").html(r + ": &yen;" + s)) : o.find(".cp_siku").html("&yen;" + n), e[a].totalSize || o.find(".shouqing_span").show()
                                }
                                $(".activtyApp_c .cp_buy").css("visibility", "visible")
                            },
                            error: function(e) {
                                console.log(e)
                            },
                            complete: function() {
                                i.length && setTimeout(function() {
                                    e(i.splice(0, 50))
                                }, 1500)
                            }
                        })
                    }
                    var t = $("input.productList");
                    if (t.length) {
                        var a = "";
                        t.each(function() {
                            a += $(this).val()
                        }), a = a.substr(0, a.length - 1);
                        var i = a.split(",");
                        e(i.splice(0, 50))
                    }
                },
                lazyLoadImg: function() {
                    $.fn.picLazyLoad = function(e) {
                        var t = $(this),
                            a = $(window),
                            i = /_\!\!\d*x\d*(_\d*)?\.webp$/gi,
                            o = /\.(gif|bmp|webp)$/i,
                            n = /\.webp$/i,
                            r = /secooimg.com/i,
                            s = (app.getQueryString("id"), !0),
                            c = 1 != app.getQueryString("noWebp"),
                            d = {
                                settings: $.extend({
                                    winHeight: a.height(),
                                    loadTime: null,
                                    failList: [],
                                    offsetArr: [],
                                    advanceHeight: 200,
                                    showTime: "0.1s",
                                    target: a,
                                    placeholder: "//mpic.secooimg.com/zhuanti_pic/back.png",
                                    frequency: 20,
                                    loadWebp: !0
                                }, e || {}),
                                init: function() {
                                    var e = this,
                                        i = e.settings,
                                        o = e.fn;
                                    return t.each(function(e, t) {
                                        o.setImgSrc($(t), i.placeholder, !0)
                                    }), 0 == i.winHeight ? (a.on("resize", function() {
                                        i.winHeight = $(window).height(), o.imgAction(), e.scrollAction()
                                    }), void 0) : (o.imgAction(), e.scrollAction(), void 0)
                                },
                                scrollAction: function() {
                                    var e = this,
                                        t = e.settings,
                                        a = e.fn;
                                    t.target.on("scroll", function() {
                                        clearTimeout(t.loadTime), t.loadTime = setTimeout(function() {
                                            a.imgAction()
                                        }, t.frequency)
                                    })
                                },
                                fn: {
                                    imgAction: function() {
                                        var e = this,
                                            a = d.settings,
                                            p = "https:" == location.protocol;
                                        t.each(function(t, d) {
                                            var d = $(d),
                                                l = d.offset().top;
                                            if ((l || 0 == l) && e.inViewport(d)) {
                                                var u = d.attr("data-original");
                                                if (!u) return;
                                                if (c && a.loadWebp && m && s && !o.test(u) && r.test(u)) u += "_!!0x0.webp";
                                                else if (!m && n.test(u)) {
                                                    var g = (i.exec(u) || [])[0];
                                                    g && (u = u.replace(g, ""))
                                                }
                                                p && 0 == u.indexOf("http:") && (u = u.replace("http:", "https:")), e.loading(u, function() {
                                                    e.setImgSrc(d, u)
                                                })
                                            }
                                        })
                                    },
                                    inViewport: function(e) {
                                        var t = d.settings,
                                            a = t.target,
                                            i = "" == a.selector ? 0 : a.offset().top,
                                            o = a.scrollTop(),
                                            n = o + a.height(),
                                            r = e.offset().top;
                                        r = "" == a.selector ? r : r + o - i;
                                        var s = r + e.height();
                                        return r >= o && r <= n + t.advanceHeight || s >= o && n >= s
                                    },
                                    loading: function(e, t) {
                                        var a = this,
                                            i = new Image;
                                        e && (i.onload = function() {
                                            delete i, t && t()
                                        }, i.onerror = function() {
                                            d.settings.failList.push(e), a.loadFail(), delete i
                                        }, i.src = e)
                                    },
                                    setImgSrc: function(e, t, a) {
                                        var i = this;
                                        if (a) e.is("img") ? e.attr("src") || e.attr("src", t) : "none" == e.css("background-image") && e.css("background-image", "url(" + t + ")");
                                        else {
                                            if (!e.attr("data-original")) return;
                                            e.is("img") ? e.attr("src", t) : e.css("background-image", "url(" + t + ")"), i.lazyloadOut(e), e.removeAttr("data-original")
                                        }
                                    },
                                    loadFail: function() {
                                        var e = 3,
                                            t = this,
                                            a = d.settings,
                                            i = setInterval(function() {
                                                e--;
                                                var o = a.failList,
                                                    n = o.length;
                                                if (0 == n || 0 >= e) return clearInterval(i), void 0;
                                                for (var r = !1, s = 0; n > s && !r; s++) ! function(e) {
                                                    var a = new Image;
                                                    a.onload = function() {
                                                        var a = $("img[data-original='" + o[e] + "']");
                                                        a.attr("src", o[e]), t.lazyloadOut(a), a.removeAttr("data-original"), o.splice(e, 1), r = !0
                                                    }, a.src = o[e]
                                                }(s)
                                            }, 1500)
                                    },
                                    lazyloadOut: function(e) {
                                        e.css({
                                            "-webkit-animation-name": "slideOut",
                                            "-webkit-animation-duration": d.settings.showTime
                                        })
                                    }
                                }
                            };
                        d.init()
                    }
                },
                exposure: function(e, t) {
                    function a(t) {
                        $.each(c, function(a, o) {
                            if (!o.isExposure && t >= o.top) {
                                o.isExposure = !0;
                                var n = i.handleEventData(e.eq(a), null, !0);
                                n ? i.statistics(n.statisticsData) : ""
                            }
                        })
                    }
                    var i = this,
                        o = null,
                        t = t || $(window),
                        n = t.selector,
                        r = t.height() + (n ? t.offset().top : 0),
                        s = r + t.scrollTop(),
                        c = e.map(function(e, t) {
                            return {
                                top: $(t).offset().top,
                                isExposure: !1
                            }
                        });
                    return t.on("scroll", function() {
                        clearTimeout(o), o = setTimeout(function() {
                            a(r + t.scrollTop())
                        }, 200)
                    }), 0 == r ? (t.on("resize", function() {
                        r = t.height(), a(s)
                    }), void 0) : (a(s), void 0)
                },
                nativeShareAction: function(e, t, a) {
                    var i = this;
                    void 0 !== a && (app.shareParams.noToast = !!a), i.deviceType.inApp && i.nativeShare(app.shareParams, e, t)
                },
                nativeShare: function(e, t, a) {
                    var i = this;
                    jsBridge.callHandler("JsCallNativeMethod", {
                        action: "share",
                        needResult: !0,
                        data: {
                            service: a || "default",
                            title: e.title,
                            url: e.url,
                            description: e.des,
                            thumbnailUrl: e.imgUrl,
                            imageUrl: e.shareImgUrl || ""
                        }
                    }, function(a) {
                        if (0 == a.errorCode) {
                            switch (a.data.state) {
                                case "success":
                                    i.getIosPoints(!e.noToast);
                                    break;
                                case "fail":
                                    break;
                                case "cancel":
                                    break;
                                case "not_available":
                                    app.toast("您尚未安装微信，暂时无法分享")
                            }
                            t && t(a), window.shareCb && window.shareCb(a)
                        }
                    })
                },
                getIosPoints: function(e) {
                    var t = this;
                    return "ios" != t.getDeviceType() ? (t.toast("分享成功"), void 0) : ($.ajax({
                        type: "GET",
                        dataType: "jsonp",
                        url: "//user-center.secoo.com/service/appapi/user/share",
                        data: {
                            bid: 1,
                            t: MD5((new Date).format("yyyyMMdd") + "d5s02e3f42w3d7lu9ls03lds")
                        },
                        success: function(a) {
                            0 == a.retCode ? t.toast(a.retMsg) : e && t.toast("分享成功")
                        }
                    }), void 0)
                },
                shareOption: function(e, t) {
                    var a = this,
                        i = $("#share"),
                        o = {
                            title: i.attr("data-title"),
                            des: i.attr("data-description"),
                            url: i.attr("data-url"),
                            imgUrl: i.attr("data-img-url"),
                            noToast: !!i.attr("data-no-toast")
                        },
                        n = a.shareParams,
                        r = n.url,
                        s = a.getQueryString("pageid", r),
                        c = "topicNew/";
                    return -1 == s.indexOf(c) && "/api/topic/topic_list_new" == location.pathname && (n.url = r.replace("pageid=" + s, "pageid=" + c + s)), h.tools.deepMerge(n, o, "notDeep"), e && h.tools.deepMerge(n, e, "notDeep"), a.getQueryString("fromShare", n.url) || (n.url += (/\?/g.test(n.url) ? "&" : "?") + "fromShare=1"), window.wx && (n.type = 5, window.wx.miniProgram.postMessage({
                        data: n
                    })), "wap" == a.getDeviceType() ? (a.wapShare(n, t), n) : (t && t(n), n)
                },
                wapShare: function(t, i) {
                    var o = t.title,
                        n = t.des,
                        r = t.url,
                        s = t.imgUrl;
                    e.mShareTrigger = function() {}, e.mSareCallback = function() {}, e.mSareCancel = function() {}, $.ajax({
                        url: "//weixin.secoo.com/activity/couplet/getSignatureByUrl.do",
                        type: "get",
                        data: "url=" + encodeURIComponent(a),
                        dataType: "jsonp",
                        success: function(e) {
                            wx.config({
                                debug: !1,
                                appId: "wxd400b479b9a80bd0",
                                timestamp: e.timestamp,
                                nonceStr: e.noncestr,
                                signature: e.Signature,
                                jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage", "onMenuShareQQ", "onMenuShareWeibo"]
                            }), wx.ready(function() {
                                wx.onMenuShareTimeline({
                                    title: n,
                                    link: r,
                                    imgUrl: s,
                                    trigger: mShareTrigger,
                                    success: mSareCallback,
                                    cancel: mSareCancel
                                }), wx.onMenuShareAppMessage({
                                    title: o,
                                    desc: n,
                                    link: r,
                                    imgUrl: s,
                                    type: "",
                                    dataUrl: "",
                                    trigger: mShareTrigger,
                                    success: mSareCallback,
                                    cancel: mSareCancel
                                }), wx.onMenuShareQQ({
                                    title: o,
                                    desc: n,
                                    link: r,
                                    imgUrl: s,
                                    trigger: mShareTrigger,
                                    success: mSareCallback,
                                    cancel: mSareCancel
                                }), wx.onMenuShareWeibo({
                                    title: o,
                                    desc: n,
                                    link: r,
                                    imgUrl: s,
                                    trigger: mShareTrigger,
                                    success: mSareCallback,
                                    cancel: mSareCancel
                                })
                            }), i && i()
                        },
                        error: function() {
                            console.log("m站获取微信签名失败，分享到微信的标题、描述将不准确")
                        }
                    })
                },
                jsBridgeInit: function(t) {
                    this.deviceType.inApp && (e.WebViewJavascriptBridge ? t(e.WebViewJavascriptBridge) : document.addEventListener("WebViewJavascriptBridgeReady", function() {
                        t(e.WebViewJavascriptBridge)
                    }, !1))
                },
                miniprogramInit: function(e) {
                    var t = this;
                    "baiduProgram" != t.getDeviceType() && wx.miniProgram.getEnv(function(a) {
                        a.miniprogram && (t.miniprogramAction(), t.cookie("isMiniProgram", !0), wx.miniProgram.postMessage({
                            data: app.shareParams
                        }), e && e())
                    })
                },
                miniprogramAction: function() {
                    this.deviceType.miniProgram = !0, $("#header").hide()
                },
                iosAction: function(t) {
                    var a = this,
                        i = a.getDeviceType();
                    "ios" == i && a.jsBridgeInit(function(i) {
                        e.jsBridge = i, e.Comm = {
                            content: {
                                bridge: i
                            },
                            callNative: function() {}
                        }, i.callHandler("jsDocumentDidFinishLoading", "", function() {}), a.bindEvent(), a.initAppInfo(), t && t()
                    })
                },
                androidAction: function(t) {
                    var a = this,
                        i = a.getDeviceType();
                    "android" == i && (app.newVersion ? a.jsBridgeInit(function(i) {
                        e.jsBridge = i, e.JsBridge = i, a.bindEvent(), console.log("新方法绑定"), a.initAppInfo(), a.initAndroidPv(), t && t()
                    }) : (e.jsBridge = e.JsBridge, a.bindEvent(), console.log("旧方法绑定"), t && t()))
                },
                nativeAction: function(t) {
                    var a = this;
                    a.deviceType.inApp && (e.nativeShare = app.nativeShareAction.bind(app), a.androidAction(t), a.iosAction(t))
                },
                wapAction: function(e) {
                    var t = this;
                    h.exports.deviceType.inApp || (t.miniprogramInit(), t.headBarInit(e), t.bindEvent(), "wap" == t.getDeviceType() && t.loadJs("//mstatic.secooimg.com/activity2018/js/comm/mar.js", function() {}, "async"))
                },
                initAppInfo: function() {
                    var e = this;
                    !h.isInit && e.newVersion && jsBridge.callHandler("JsCallNativeMethod", {
                        action: "getAppInfo",
                        needResult: !0
                    }, function(t) {
                        e.appInfo = t.data
                    })
                },
                initAndroidPv: function() {
                    app.matchVersion({
                        android: "6.1.11"
                    }, function() {}, function() {
                        jsBridge.callHandler("JsCallNativeMethod", {
                            action: "getAppInfo",
                            needResult: !0
                        }, function(e) {
                            e = e.data;
                            var t = e.deviceId,
                                a = t,
                                i = t;
                            t.indexOf("_") > 0 && (a = t.split("_")[0]), app.getUpk(function(t) {
                                jsBridge.callHandler("JsCallNativeMethod", {
                                    action: "getNetworkInfo",
                                    needResult: !0
                                }, function(o) {
                                    var n = {
                                            1: "WIFI",
                                            2: "OTHER",
                                            3: "2G",
                                            4: "3G",
                                            5: "4G"
                                        },
                                        r = new Date,
                                        s = {
                                            "s.paid": app.pageid,
                                            "s.ot": 1,
                                            "s.imei": a,
                                            "s.uuid": i,
                                            "s.cid": e.channel,
                                            "s.uid": t,
                                            "s.ntt": n[o.data.networkType],
                                            "s.cv": e.appVersion,
                                            "s.appid": e.appId,
                                            "s.optm": Math.round(r.getTime() / 1e3),
                                            "s.ltm": r.format("yyyy-MM-dd hh:mm:ss")
                                        };
                                    $.post("//datacollect.secoo.com/c/dcs.gif", app.jsonToUrlParams(s))
                                })
                            })
                        })
                    })
                },
                init: function(t) {
                    var a = this;
                    d.setRem !== !1 && h.setRem(d.baseRemVal || 10), h.extendOriginObj(), a.getDeviceType(), window.loadJs = app, window.getCookie = app.cookie, a.getPageId(), h.exports.deviceType.inApp || h.statistic.google(), 0 != d.useSensors && h.statistic.sensors({
                        sdk_url: "https://mstatic.secooimg.com/sensors/sensorsdata.min.js",
                        heatmap_url: "https://mstatic.secooimg.com/sensors/heatmap.min.js",
                        name: "sensors",
                        web_url: "https://sensorsdata.secoo.com/?project=production",
                        server_url: "https://collect.secoo.com/sa?project=production",
                        heatmap: {
                            clickmap: "default",
                            scroll_notice_map: "default",
                            isTrackLink: !1,
                            loadTimeout: 3e3,
                            collect_input: function() {
                                return !1
                            },
                            element_selector: "not_use_id",
                            renderRefreshTime: 1e3,
                            scroll_delay_time: 4e3
                        },
                        show_log: !!d.showSensorsLog || !1,
                        use_app_track: h.exports.deviceType.inApp
                    }), a.loadJs(h.tools.concatJs(t ? t.loadJsArr : []), function() {
                        function a() {
                            h.isInit = !0, d.jsLoaded && d.jsLoaded(), e.jsLoaded && e.jsLoaded(), e.addScript && e.addScript()
                        }
                        app.shareOption(t && t.share ? t.share : null), app.deviceType.inApp ? app.nativeAction(function() {
                            a()
                        }) : (app.wapAction(t), a())
                    }, !1, function() {
                        app.cookie("appsource") || app.cookie("appsource", "60", "", "secoo.com"), app.lazyLoadImg(), 0 != d.imgLazyLoad && $("[data-original]").picLazyLoad(), a.setProductPrice(), app.toast(), d.zeptoLoaded && d.zeptoLoaded(), e.zeptoLoaded && e.zeptoLoaded()
                    })
                }
            }
        };
    return h.exports
}(window, document);
app.init(window.pageConfig || {});